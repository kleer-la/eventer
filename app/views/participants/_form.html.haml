%script(src="https://www.google.com/recaptcha/api.js")
= form_for [:event, @participant] do |f|
  - if @event.is_sold_out
    .alert
      = I18n.t("formtastic.labels.event.alert.is_sold_out").html_safe
  - if @participant.errors.full_messages.count > 0 || @captcha_error
    .alert.alert-danger{:id => "validation_msg"}
      = "Complete los campos con * y el captcha"
  %fieldset.inputs
    - if @nakedform
      %input{ :type => "hidden", :name => "nakedform", :value => "1" }

    - utm_campaign = params[:utm_campaign]
    - utm_source = params[:utm_source]

    - if !utm_campaign.nil?
      %input{ :type => "hidden", :name => "utm_campaign", :value => utm_campaign }

    - if !utm_source.nil?
      %input{ :type => "hidden", :name => "utm_source", :value => utm_source }

    .row-fluid
      .control-group
        = f.text_field :fname, required: true, :class => "span12", :placeholder => '* '+I18n.t("formtastic.labels.participant.fname")
    .row-fluid
      .control-group
        = f.text_field :lname, required: true, :class => "span12", :placeholder => '* '+I18n.t("formtastic.labels.participant.lname")
    .row-fluid
      .control-group
        - email_placeholder = '* '+ I18n.t("formtastic.labels.participant.email")
        - email_placeholder += " (confirmaremos tu registro en este email)"
        = f.email_field :email, required: true, :class => "span12", :placeholder => email_placeholder
    .row-fluid
      .control-group
        = f.text_field :company_name, required: false, :class => "span12", :placeholder => I18n.t("formtastic.labels.participant.invoice_name")
    .row-fluid
      .control-group
        = f.text_field :address, required: true, :class => "span12", :placeholder => '* '+ I18n.t("formtastic.labels.participant.address")
    - if @event.should_ask_for_referer_code
      .row-fluid
        .control-group
          = f.text_field :referer_code, :class => "span6", :placeholder => I18n.t("formtastic.labels.participant.referer_code")
    .row_fluid
      .control-group
        %small.muted
        = f.select :quantity, @quantities, {}, {:class => "span6"}
    .row-fluid
      .control-group
        = f.phone_field :phone, :class => "span12", :placeholder => I18n.t("formtastic.labels.participant.phone")
    .row-fluid
      .control-group
        = f.text_area :notes, :class => "span12 autogrow", :placeholder => I18n.t("formtastic.labels.participant.notes"), :rows => 2
    .row-fluid
      .control-group
        %label.checkbox
          = f.check_box :accept_terms, :required => true
          %label.control-label{ :for => :accept_terms }= ('* '+ I18n.t("formtastic.labels.participant.accept_terms")).html_safe
    .row-fluid
      = recaptcha_tags(expired_callback: 'grecaptcha.reset()')

    .row-fluid
      .form-actions{ :style => "padding: 4px 20px 4px; margin-top: 0px;"}
        .text-center
          - if session[:payment_on_eventer]
            %button.btn.btn-success.btn-large{:name => "commit", :type => "submit", :style => "margin-top: 0px;"}
              %i.icon-flag
              = I18n.t("formtastic.button.participant.pay")
          - else
            %button.btn.btn-primary.btn-large{:name => "commit", :type => "submit", :style => "margin-top: 0px;"}
              %i.icon-save
              - if @event.community_event?
                = I18n.t("formtastic.button.participant.register")
              - else
                = I18n.t("formtastic.button.participant.buy")

= @event.experimental_features
